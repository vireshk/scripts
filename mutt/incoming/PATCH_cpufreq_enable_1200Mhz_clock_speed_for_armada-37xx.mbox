From vireshk  Tue Nov 26 08:34:59 2024
Delivered-To: viresh.kumar@linaro.org
Received: from pop.gmail.com [74.125.200.109] 	by vireshk-i7 with POP3 (fetchmail-6.4.2) 	for <vireshk@localhost> (single-drop); Tue, 26 Nov 2024 08:34:59 +0530 (IST)
Received: by 2002:a05:7208:8089:b0:92:10b5:baa3 with SMTP id k9csp1575733rbd;         Mon, 25 Nov 2024 13:15:40 -0800 (PST)
X-Forwarded-Encrypted: i=2; AJvYcCX/+0iuW5JyammbW5MZAwe0raitDv2FLNmKKp2SE2L3xTNLYhh9I/nuTKH8JWvRV7DpxNoPe24ekXy/iwM=@linaro.org
X-Received: by 2002:a05:6a20:3947:b0:1db:fffd:5408 with SMTP id adf61e73a8af0-1e09e3f538emr21732111637.8.1732569340224;         Mon, 25 Nov 2024 13:15:40 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1732569340; cv=none;         d=google.com; s=arc-20240605;         b=GNGl0I+zmqZe61rQCDl8Vnw+DmwMnjrj/GvJxFq3qFYY4ER1ZXgUxzUpw7AgHW3fB1          xLNQGdwXtUwnQ5737a7OgrBpDo7neL8/ip8QawiKnp79oU7kZ/m42c8Wi5JZiABWl0rR          kppLbZbXUNwBsTi2JGIJCeGkTSfzQhRBPf6NHnngiNTunnScZGPiXHSAVPqXmvkf0eMK          yvQ3jYU+q2jm87Nl8PrJnAV3j8lmk9BmDYMewfqAhAFgRKM8VecZGQSAFaUg3ORjfDvw          0gpbFAohNHZI/ZuK3QHqFICU1TLxlUbg4MghL6GvcwvzlGgKoGDIBSKZ8+wOqnJ3/pcE          Rr+A==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20240605;         h=content-transfer-encoding:mime-version:message-id:date:subject:cc          :to:from:dkim-signature;         bh=0ZHTGGztVRlr02UorCZLeEgiwydMSFEuesYKwn9RtUI=;         fh=CzyO4R9IQW4gmS2G0Gw0Yopo7c2dcaalyolhzDAmtbo=;         b=cYauM1BteeRNsx7+vFoJ86os5HQdnf+NJC6ZaBdRPxKSe83LYqvsyHEZ651o0IhdOF          07FiU0VuVeu2jwsnG1Ff2KZKQ6y7JdRI1MayfTFs94JBlXHGv8U5x5xJu25441toPMY8          PnToHmS6/YvKAVuojiYEg7T7qDv/wRHek1JJjiy/gkRUjcvnAmhxKb0DTaeZOtSAXX2z          HbjY52FiSLdWnPrcc44CHjYD4/3A9gDBr+Ubos6kARMESNT3IJiVCBTm/haKZV15dZq+          aj2Hk0jMLO5UvBVZegeypLx/Ph4ICA+czayJExCGoGbAftdEBlCeVt2je3DLbX6/wgAm          s6eA==;         dara=google.com
ARC-Authentication-Results: i=1; mx.google.com;        dkim=pass header.i=@gmail.com header.s=20230601 header.b=TMxUjeDR;        spf=pass (google.com: domain of bschnei@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom=bschnei@gmail.com;        dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com;        dara=neutral header.i=@linaro.org
Return-Path: <bschnei@gmail.com>
Received: from mail-sor-f41.google.com (mail-sor-f41.google.com. [209.85.220.41])         by mx.google.com with SMTPS id 41be03b00d2f7-7fbcc3ee54bsor5143020a12.5.2024.11.25.13.15.40         for <viresh.kumar@linaro.org>         (Google Transport Security);         Mon, 25 Nov 2024 13:15:40 -0800 (PST)
Received-SPF: pass (google.com: domain of bschnei@gmail.com designates 209.85.220.41 as permitted sender) client-ip=209.85.220.41;
Authentication-Results: mx.google.com;        dkim=pass header.i=@gmail.com header.s=20230601 header.b=TMxUjeDR;        spf=pass (google.com: domain of bschnei@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom=bschnei@gmail.com;        dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com;        dara=neutral header.i=@linaro.org
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;         d=gmail.com; s=20230601; t=1732569340; x=1733174140; darn=linaro.org;         h=content-transfer-encoding:mime-version:message-id:date:subject:cc          :to:from:from:to:cc:subject:date:message-id:reply-to;         bh=0ZHTGGztVRlr02UorCZLeEgiwydMSFEuesYKwn9RtUI=;         b=TMxUjeDRvyKzpLTvscBh1pzVyRwNweKppZVg2CN9zYiU2/54i7E6Emd4J7U1cjviHm          n2+ZX6YeCAgWY0PHATzUSV2oPFkj48mF+p6ZH7bcVR9QKvVAeuSAdvrBDpKYROqLDxKW          QUqsJWCrHt2LZG8G2ev5yRUIEj4vsi+wBtdOnGWbaDsoTvIqmtg4thRMeApEyYwFLuVx          yxbNNRpygPJrhtZGbNOHtzxwvVNPhcL0lKShKcvOVDFHFsZw8ZNXAkxei3rXOvvqKY8/          jUQKX27REAXlkz1suWJDu8LQ4XF9BA5in6czu/k80mv7dm3ekJDyPXMkreYqIzulU6Mw          o93A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;         d=1e100.net; s=20230601; t=1732569340; x=1733174140;         h=content-transfer-encoding:mime-version:message-id:date:subject:cc          :to:from:x-gm-message-state:from:to:cc:subject:date:message-id          :reply-to;         bh=0ZHTGGztVRlr02UorCZLeEgiwydMSFEuesYKwn9RtUI=;         b=YJoBd5JTJ8JGto1l7JLeZDiVPjsKabqcFOQdgC1mrsR4X5b4BoKqXTSToAKcRXhHuz          jJn8J0L2pp7LJnArFMGQOw7+ymhuhhWEut8sqb1Zyc4Mz6CWeLyaHriUD9LDN4rnJ6cF          TNCxW4VhX17HGgnjVBMjantZvLV2TbKF42ZFTis6qGlaWYMx54GVK4WPK2tA8Iv9hdhO          R8jbpH64bjnrAMa9mJkuhIyWb0OSGbCZ7/IPEj3sdbUh2pnak36EPjRp7SxS6bbeYeMK          HVgiJPa1/nnlHVJMV6/+y6VUEPfg83/cgefJAeKPdzcqE8tlHRSY+uY36vMVSHnbKaca          7U4g==
X-Forwarded-Encrypted: i=1; AJvYcCWFRU2G/4NBZyeBBbMcRPcJe3alNqR6wcfiOOchBRRh2NMOVKNPV2B5bAs0Q0N5v/xrmVdJxv3thZ2Erbc=@linaro.org
X-Gm-Message-State: AOJu0YyywFe6Kq2lGV2Te7UEnFcF56NbAeWiKs6+hEK71J3Q3UR0/sco 	E1TDq29TWCh4FLcbMcFHTGP4U9UmA404Hb/TIZw6HibwfksLxkkp
X-Gm-Gg: ASbGnctmkyAqfUQcMTFVbLzVWMzGqORI7GyE2aum6Im5tIBKuLUwPz46m3B/EhfVLKn 	NdNAYCMlP1TaR42q/QfdlY8WuhkmqsRhq5s4IcintTWqPHWibVg1pnOQZLiPwqBeA2mo6gGHHgt 	OoC//K95k7Ch+iAoklXenYVTNW/bpsyyIpYqaDL5LV4tTJDz6tkPRWmJSABd2OEI+882nziAc35 	gazgVu4sSBdKXXxYEPXr4kK9VkWfGUUAFwtKk+kfxp43E8z8g==
X-Google-Smtp-Source: AGHT+IHrsrU0BqzKKN0+sv8jhNnr6cs9rDOsCM8lLkVi9yLVElzX7tpOkme2fiVg4jFUx0MfT1dtog==
X-Received: by 2002:a05:6a20:c89b:b0:1dc:1147:a632 with SMTP id adf61e73a8af0-1e09e5cb4c5mr23461978637.37.1732569339517;         Mon, 25 Nov 2024 13:15:39 -0800 (PST)
Return-Path: <bschnei@gmail.com>
Received: from desky.home.arpa ([2605:59c8:492:c300:8a72:2d07:5f93:a09b])         by smtp.gmail.com with ESMTPSA id d2e1a72fcca58-724de454967sm6907470b3a.19.2024.11.25.13.15.38         (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);         Mon, 25 Nov 2024 13:15:39 -0800 (PST)
From: bschnei@gmail.com
X-Google-Original-From: ben@bens.haus
To: "Rafael J . Wysocki" <rafael@kernel.org>, 	Viresh Kumar <viresh.kumar@linaro.org>
Cc: Sebastian Hesselbarth <sebastian.hesselbarth@gmail.com>, 	linux-arm-kernel@lists.infradead.org, 	linux-pm@vger.kernel.org, 	linux-kernel@vger.kernel.org, 	Benjamin Schneider <ben@bens.haus>, 	=?UTF-8?q?Pali=20Roh=C3=A1r?= <pali@kernel.org>, 	Andrew Lunn <andrew@lunn.ch>, 	Gregory CLEMENT <gregory.clement@bootlin.com>
Subject: [PATCH] cpufreq: enable 1200Mhz clock speed for armada-37xx
Date: Mon, 25 Nov 2024 13:14:52 -0800
Message-ID: <20241125211452.14987-1-ben@bens.haus>
X-Mailer: git-send-email 2.47.1
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Label: apply
Status: RO
X-Status: A
Content-Length: 1796
Lines: 41

From: Benjamin Schneider <ben@bens.haus>

This frequency was disabled because of stability problems whose source could
not be accurately identified[1]. After seven months of testing, the evidence
points to an incorrectly configured bootloader as the source of the historical
instability. Testing was performed on two A3720 devices with this frequency
enabled and the ondemand policy in use. Marvell merged[2] changes to their
bootloader source needed to address the stability issue. This driver should
expose this frequency option to users.

[1] https://github.com/torvalds/linux/commit/484f2b7c61b9ae58cc00c5127bcbcd9177af8dfe
[2] https://github.com/MarvellEmbeddedProcessors/mv-ddr-marvell/pull/44

Signed-off-by: Benjamin Schneider <ben@bens.haus>
Reviewed-by: Pali Roh√°r <pali@kernel.org>
Reviewed-by: Andrew Lunn <andrew@lunn.ch>
Acked-by: Gregory CLEMENT <gregory.clement@bootlin.com>
---
 drivers/cpufreq/armada-37xx-cpufreq.c | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

diff --git a/drivers/cpufreq/armada-37xx-cpufreq.c b/drivers/cpufreq/armada-37xx-cpufreq.c
index bea41ccabf1f..f28a4435fba7 100644
--- a/drivers/cpufreq/armada-37xx-cpufreq.c
+++ b/drivers/cpufreq/armada-37xx-cpufreq.c
@@ -102,11 +102,7 @@ struct armada_37xx_dvfs {
 };
 
 static struct armada_37xx_dvfs armada_37xx_dvfs[] = {
-	/*
-	 * The cpufreq scaling for 1.2 GHz variant of the SOC is currently
-	 * unstable because we do not know how to configure it properly.
-	 */
-	/* {.cpu_freq_max = 1200*1000*1000, .divider = {1, 2, 4, 6} }, */
+	{.cpu_freq_max = 1200*1000*1000, .divider = {1, 2, 4, 6} },
 	{.cpu_freq_max = 1000*1000*1000, .divider = {1, 2, 4, 5} },
 	{.cpu_freq_max = 800*1000*1000,  .divider = {1, 2, 3, 4} },
 	{.cpu_freq_max = 600*1000*1000,  .divider = {2, 4, 5, 6} },
-- 
2.47.1

