From vireshk  Tue Oct  1 08:45:17 2024
Delivered-To: viresh.kumar@linaro.org
Received: from pop.gmail.com [142.251.175.108] 	by vireshk-i7 with POP3 (fetchmail-6.4.2) 	for <vireshk@localhost> (single-drop); Tue, 01 Oct 2024 08:45:17 +0530 (IST)
Received: by 2002:a05:7208:c243:b0:8b:2085:db5e with SMTP id w3csp1027250rbd;         Wed, 18 Sep 2024 17:09:40 -0700 (PDT)
X-Forwarded-Encrypted: i=2; AJvYcCW/MtKFJhS4j2x6qMqsJZbNaMip82rHLb0G6s48MMWk9VyPILRqwbioBeovEs7qwx5/lqGM9srLvVKh/bo=@linaro.org
X-Received: by 2002:a05:6902:2293:b0:e0b:1407:e31d with SMTP id 3f1490d57ef6-e1daff63789mr15940417276.7.1726704579778;         Wed, 18 Sep 2024 17:09:39 -0700 (PDT)
ARC-Seal: i=1; a=rsa-sha256; t=1726704579; cv=none;         d=google.com; s=arc-20160816;         b=YcoWx4LrmFC+03raKEdhgKQoC6ctWiQwwAfwg0C9AJm526JgCzUeMtjsna7St/G90m          TfNrZS7OyD5u97s+FEzomjP4MyYmXwq9S+b4wKy46y2evtEKeJhiUqWxOlCTgra4TGhT          mx6SUWDwPwWNm5o396ownXLLzdiw5gwmiTRdOECpQMoWJv4vZ5Zr0X3Db1HhpoAieYpJ          WdnggDukVZHfkukGZOcapO1d5LYC6CKNdm3Z3H8Y8QghLikwG27wdnfbNyW9aj1p7ZWr          zaUd0+WZwbeQM6e29ZlQG1sqNXZTYlxMR5xKyZT3Rb+oUDrS2YUfDkasT29+vBQ42n3J          Auyw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;         h=cc:to:from:subject:message-id:references:mime-version:in-reply-to          :date:dkim-signature;         bh=i3NxGwHKiPartzkPCOrFEH3MzGEQYYqX3F8NtYxKTlM=;         fh=V0H7DMlHKkceeKb/9oCPpiJL9gW/F7urAXo8x2W7Ok8=;         b=sdmWX535pK5kDsV1AcFIDA4O+i8fO2396nL2SUXhs2lDIKKZzf4BQfv2K25mjT2vvf          OZSIhtD05rZp6qNLBQ+rjHevYgPIDlAhTXfVZ/drfSZVVjTTG7dXXtCjH6qgR4HAH8l9          9o2gfokvhFlJwp7q7lnmYaSIwFnF25E6AuOSs/9VygdtwfJ/XC/NYTk3V+3M/i1+r2oY          QdYPmjqCl9Waam58sO9Q3xolgkRqbNvtQzai0rSvA4psJIaMzktaeVjDsRdSAT2oVLXJ          hlNzIAHVld4KdtF2GUsjq4weM1a/fekBw7VvXGay+6ZYzYItk2mxAFMnPSxIZ7RnS0YY          N86Q==;         dara=google.com
ARC-Authentication-Results: i=1; mx.google.com;        dkim=pass header.i=@google.com header.s=20230601 header.b=AlfLyb8r;        spf=pass (google.com: domain of 3w2vrzgckdiynk5snksqyyqvo.myw5s1o2r.u4wk1vsxk1y.y1q@flex--davidai.bounces.google.com designates 209.85.220.73 as permitted sender) smtp.mailfrom=3w2vrZgcKDIYnk5snksqyyqvo.myw5s1o2r.u4wk1vsxk1y.y1q@flex--davidai.bounces.google.com;        dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=google.com;        dara=neutral header.i=@linaro.org
Return-Path: <3w2vrZgcKDIYnk5snksqyyqvo.myw5s1o2r.u4wk1vsxk1y.y1q@flex--davidai.bounces.google.com>
Received: from mail-sor-f73.google.com (mail-sor-f73.google.com. [209.85.220.73])         by mx.google.com with SMTPS id 3f1490d57ef6-e1dc113dfc8sor4695762276.8.2024.09.18.17.09.39         for <viresh.kumar@linaro.org>         (Google Transport Security);         Wed, 18 Sep 2024 17:09:39 -0700 (PDT)
Received-SPF: pass (google.com: domain of 3w2vrzgckdiynk5snksqyyqvo.myw5s1o2r.u4wk1vsxk1y.y1q@flex--davidai.bounces.google.com designates 209.85.220.73 as permitted sender) client-ip=209.85.220.73;
Authentication-Results: mx.google.com;        dkim=pass header.i=@google.com header.s=20230601 header.b=AlfLyb8r;        spf=pass (google.com: domain of 3w2vrzgckdiynk5snksqyyqvo.myw5s1o2r.u4wk1vsxk1y.y1q@flex--davidai.bounces.google.com designates 209.85.220.73 as permitted sender) smtp.mailfrom=3w2vrZgcKDIYnk5snksqyyqvo.myw5s1o2r.u4wk1vsxk1y.y1q@flex--davidai.bounces.google.com;        dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=google.com;        dara=neutral header.i=@linaro.org
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;         d=google.com; s=20230601; t=1726704579; x=1727309379; darn=linaro.org;         h=cc:to:from:subject:message-id:references:mime-version:in-reply-to          :date:from:to:cc:subject:date:message-id:reply-to;         bh=i3NxGwHKiPartzkPCOrFEH3MzGEQYYqX3F8NtYxKTlM=;         b=AlfLyb8rQZVuIpsp2TjtxLGp1Ud2JdQy3Y/mlmLTXE5iOsAAPQbs+kGr0/jx1e7DfH          luiVy4qRfljY3e44PnMcFGkfG7C2i/zMXYqpp1Bphglqzf1AWbRIvf9kfrV44bfmdX5M          gMeT3xLb/SArGeiD8j1t6VBBWfb2xVR3vvS4I0KczkzvuvOrdOc58J3wHqroAl/tbhM+          G/iCUcV3M1TBxdnqQNtRuBOr6iWpFQ2Okd5uKW40cWeUa6HwBRfoYqVBLQuJSpLF6oPp          IDrorS5AmuRGOEvv/VoEjufNDjgprXvvNoiimgpSZObqMK54a/lq3Xgqo7tDdhzoHQaZ          B+5A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;         d=1e100.net; s=20230601; t=1726704579; x=1727309379;         h=cc:to:from:subject:message-id:references:mime-version:in-reply-to          :date:x-gm-message-state:from:to:cc:subject:date:message-id:reply-to;         bh=i3NxGwHKiPartzkPCOrFEH3MzGEQYYqX3F8NtYxKTlM=;         b=DWIUfyZUqEA9s2JyAXzBYR5WJkLSwnxzK3RHT2VsvvCVxvGdYpQlM4/x6R0A5Fdofs          FXw4FoeB7RZzYpA+J+JZ9VtfpVDGJ5JHbnksicpLZ8tV6vTMKz5dEasHEOXfnTA+jNVw          RcbLJTFoA7nnDkS/ooaNpYF3t66N3wm6N8VyPC0HGAnpraXuAW3+CXQQZDWBsK9QIKE3          xA5QUWHt3kuw9hJx7BKyaF/jEnjRDwFr63IViwmYn/upmGqW/4TxX8RhrcHI+9aiv3BQ          8R9I4eMX5djDnOri2Onf4iiVtIi3AoUEQUOEt5NlZniFuTraaHE+HpZ+IonG+6gn7zc8          pU+Q==
X-Forwarded-Encrypted: i=1; AJvYcCWf2uClaNMYjaITo/9UXuCiHyhk3s9E5auH11QHK9cEqVoug/PyuwTMGuWCdea5ZrGlW2uvBVuy7V0UJBs=@linaro.org
X-Gm-Message-State: AOJu0YxlhB7/vP70jn8Pof9wBjV8kHc566AkDJzyCkMIJp3cEXmnn3/i 	7kFEVWATrS8V76CCSxFmh9EYXd1z67J2JA5EpWfkByjsMF+a2HaQIPaNhwx5/IYs4q+blD0r07l 	ZWQTi1w==
X-Google-Smtp-Source: AGHT+IHl1XmPQy3MUFnAY/RXegJ7drfzK6UvnB8cgxFfQj0i1CCiVinITS0VD+GkKMQKcoH+CWo2Mh+vGxxh
X-Received: from davidai2.mtv.corp.google.com ([2620:15c:211:201:2985:f9c1:f5a3:ad7a])  (user=davidai job=sendgmr) by 2002:a25:d895:0:b0:e11:44fb:af26 with SMTP id  3f1490d57ef6-e1d9db88758mr28547276.2.1726704579142; Wed, 18 Sep 2024 17:09:39  -0700 (PDT)
Date: Wed, 18 Sep 2024 17:08:32 -0700
In-Reply-To: <20240919000837.1004642-1-davidai@google.com>
Mime-Version: 1.0
References: <20240919000837.1004642-1-davidai@google.com>
X-Mailer: git-send-email 2.46.0.792.g87dc391469-goog
Message-ID: <20240919000837.1004642-2-davidai@google.com>
Subject: [PATCH v7 1/2] dt-bindings: cpufreq: add virtual cpufreq device
From: David Dai <davidai@google.com>
To: "Rafael J. Wysocki" <rafael@kernel.org>, Viresh Kumar <viresh.kumar@linaro.org>,  	Rob Herring <robh@kernel.org>, Krzysztof Kozlowski <krzk+dt@kernel.org>, Conor Dooley <conor+dt@kernel.org>,  	Sudeep Holla <sudeep.holla@arm.com>, David Dai <davidai@google.com>,  	Saravana Kannan <saravanak@google.com>
Cc: Quentin Perret <qperret@google.com>, Masami Hiramatsu <mhiramat@google.com>,  	Will Deacon <will@kernel.org>, Peter Zijlstra <peterz@infradead.org>,  	Vincent Guittot <vincent.guittot@linaro.org>, Marc Zyngier <maz@kernel.org>,  	Oliver Upton <oliver.upton@linux.dev>, Dietmar Eggemann <dietmar.eggemann@arm.com>,  	Pavan Kondeti <quic_pkondeti@quicinc.com>, Gupta Pankaj <pankaj.gupta@amd.com>,  	Mel Gorman <mgorman@suse.de>, kernel-team@android.com, linux-pm@vger.kernel.org,  	devicetree@vger.kernel.org, linux-kernel@vger.kernel.org
Content-Type: text/plain; charset="UTF-8"
Status: RO
Content-Length: 2594
Lines: 74

Adding bindings to represent a virtual cpufreq device.

Virtual machines may expose MMIO regions for a virtual cpufreq device
for guests to read performance information or to request performance
selection. The virtual cpufreq device has an individual controller for
each performance domain. Performance points for a given domain can be
normalized across all domains for ease of allowing for virtual machines
to migrate between hosts.

Co-developed-by: Saravana Kannan <saravanak@google.com>
Signed-off-by: Saravana Kannan <saravanak@google.com>
Signed-off-by: David Dai <davidai@google.com>
Reviewed-by: Rob Herring (Arm) <robh@kernel.org>
---
 .../cpufreq/qemu,virtual-cpufreq.yaml         | 48 +++++++++++++++++++
 1 file changed, 48 insertions(+)
 create mode 100644 Documentation/devicetree/bindings/cpufreq/qemu,virtual-cpufreq.yaml

diff --git a/Documentation/devicetree/bindings/cpufreq/qemu,virtual-cpufreq.yaml b/Documentation/devicetree/bindings/cpufreq/qemu,virtual-cpufreq.yaml
new file mode 100644
index 000000000000..018d98bcdc82
--- /dev/null
+++ b/Documentation/devicetree/bindings/cpufreq/qemu,virtual-cpufreq.yaml
@@ -0,0 +1,48 @@
+# SPDX-License-Identifier: GPL-2.0-only OR BSD-2-Clause
+%YAML 1.2
+---
+$id: http://devicetree.org/schemas/cpufreq/qemu,virtual-cpufreq.yaml#
+$schema: http://devicetree.org/meta-schemas/core.yaml#
+
+title: Virtual CPUFreq
+
+maintainers:
+  - David Dai <davidai@google.com>
+  - Saravana Kannan <saravanak@google.com>
+
+description:
+  Virtual CPUFreq is a virtualized driver in guest kernels that sends performance
+  selection of its vCPUs as a hint to the host through MMIO regions. Each vCPU
+  is associated with a performance domain which can be shared with other vCPUs.
+  Each performance domain has its own set of registers for performance controls.
+
+properties:
+  compatible:
+    const: qemu,virtual-cpufreq
+
+  reg:
+    maxItems: 1
+    description:
+      Address and size of region containing performance controls for each of the
+      performance domains. Regions for each performance domain is placed
+      contiguously and contain registers for controlling DVFS(Dynamic Frequency
+      and Voltage) characteristics. The size of the region is proportional to
+      total number of performance domains.
+
+required:
+  - compatible
+  - reg
+
+additionalProperties: false
+
+examples:
+  - |
+    soc {
+      #address-cells = <1>;
+      #size-cells = <1>;
+
+      cpufreq@1040000 {
+        compatible = "qemu,virtual-cpufreq";
+        reg = <0x1040000 0x2000>;
+      };
+    };
-- 
2.46.0.792.g87dc391469-goog

